var Countdown=function(t){function e(e){void 0===e&&(e=null),t.call(this),this._runTime=3,this.touchEnabled=!0,this.once(egret.Event.ADDED_TO_STAGE,this.createView,this),this._textureNames=e}__extends(e,t);var i=(__define,e),s=i.prototype;return s.createView=function(){this.graphics.beginFill(0,.3),this.graphics.drawRect(0,0,this.stage.stageWidth,this.stage.stageHeight),this.graphics.endFill(),this._info=new egret.TextField,this._info.width=300,this._info.height=300,this._info.size=200,this._info.textAlign="center",this._info.verticalAlign=egret.VerticalAlign.MIDDLE,this._info.strokeColor=16711680,this._info.stroke=3,this._info.x=this.width-this._info.width>>1,this._info.y=this.height-this._info.height>>1,this._bmp=new egret.Bitmap,null==this._textureNames?this.addChild(this._info):this.addChild(this._bmp),this._timer=new egret.Timer(1e3),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this)},s.run=function(){this._timer.running||(this._timer.reset(),this._timer.start(),this._info.text=this._runTime+"",null!=this._textureNames&&(this._bmp.texture=RES.getRes(this._textureNames[0])))},s.onTimer=function(t){return this._timer.currentCount>this._runTime?(this._timer.stop(),void this.dispatchEventWith("CountdownComplete")):void(null!=this._textureNames?this._bmp.texture=RES.getRes(this._textureNames[this._timer.currentCount]):this._info.text=this._runTime-this._timer.currentCount+"")},e}(egret.Sprite);egret.registerClass(Countdown,"Countdown");var Game=function(t){function e(){t.call(this),this._frameIndex=20,this.once(egret.Event.ADDED_TO_STAGE,this.init,this)}__extends(e,t);var i=__define,s=e,h=s.prototype;return i(e,"instance",function(){return this._instance||(this._instance=new e),this._instance}),h.init=function(){GameSound.sound_hit1=RES.getRes("m1"),GameSound.sound_hit2=RES.getRes("m2"),GameSound.sound_hit3=RES.getRes("hit"),this.onInit(),window.gInitialize()},h.onInit=function(){this._bg=new egret.Bitmap(RES.getRes("bg1")),this._bg.height=this.stage.stageHeight,this.addChild(this._bg),this._item2=new egret.Bitmap(RES.getRes("item2")),this._item2.x=this.stage.stageWidth-this._item2.width>>1,this.addChild(this._item2),this._szspr=new egret.Sprite,this.addChild(this._szspr),this._item1=new egret.Bitmap(RES.getRes("item1")),this._item1.x=this.stage.stageWidth-this._item1.width>>1,this.addChild(this._item1),this._item2_1=new egret.Bitmap(RES.getRes("item2s1")),this._item2_1.x=this.stage.stageWidth-this._item2_1.width>>1,this._item2_1.y=579,this._item2_1.visible=!1,this.addChild(this._item2_1),this._aitem=new egret.Bitmap,this.addChild(this._aitem),this._light=new egret.Bitmap(RES.getRes("light")),this._light.visible=!1,this.addChild(this._light),this._szarr=[],this._sarr=[new egret.Point(139,433),new egret.Point(305,401),new egret.Point(428,481),new egret.Point(302,524),new egret.Point(101,524)];for(var t=1;6>t;t++){var e=new egret.Bitmap(RES.getRes("sz"+t));this._szarr.push(e)}this._page1=new egret.Sprite,this.addChild(this._page1);var i=new egret.Bitmap(RES.getRes("bg"));i.height=this.stage.stageHeight,this._page1.addChild(i);var s=new egret.Bitmap(RES.getRes("btn"));s.x=75,s.y=this.stage.stageHeight-s.height-70,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnTouch,this),this._page1.addChild(s);var h=new egret.Bitmap(RES.getRes("back"));h.x=this.stage.stageWidth-h.width-75,h.y=this.stage.stageHeight-h.height-70,h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameSound.sound_hit2.play(0,1),window.backHome()},this),this._page1.addChild(h),this._back=new egret.Bitmap(RES.getRes("restart")),this._back.x=75,this._back.y=this.stage.stageHeight-this._back.height-50,this._back.visible=!1,this._back.touchEnabled=!0,this._back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.back,this),this.addChild(this._back),this._home=new egret.Bitmap(RES.getRes("back")),this._home.width=this._back.width,this._home.height=this._back.height,this._home.x=this.stage.stageWidth-this._home.width-75,this._home.y=this.stage.stageHeight-this._home.height-50,this._home.visible=!1,this._home.touchEnabled=!0,this._home.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameSound.sound_hit2.play(0,1),window.backHome()},this),this.addChild(this._home),this._ty=new egret.Bitmap(RES.getRes("ty")),this._ty.y=this.stage.stageHeight-this._ty.height,this._ty.visible=!1,this.addChild(this._ty),this._orientation=new egret.DeviceOrientation},h.start=function(){this.reset()},h.reset=function(){this._findex=0,this._yaoNum=0,this._left=0,this._right=0},h.btnTouch=function(){GameSound.sound_hit3.play(0,1),this._page1.visible=!1,this._sindex=2,this.pageReset(this._sindex)},h.pageReset=function(t){this._bg.texture=RES.getRes("bg1"),this._bg.name="bg1",this._szspr.removeChildren();for(var e=0,i=this._szarr.length-t;i>e;e++)this._szarr[e].x=this.stage.stageWidth,this._szarr[e].y=200+50*e,this._szspr.addChild(this._szarr[e]),egret.Tween.get(this._szarr[e]).to({y:620-this._szarr[e].height-15*e,x:200+60*e},350+100*e);this._item1.visible=!0,this._item2.visible=!0,this._item1.y=106,this._item1.rotation=-20,this._item2.y=639,egret.Tween.get(this._item1).to({y:306,rotation:0},700).call(function(){this._ty.visible=!0,this._orientation.addEventListener(egret.Event.CHANGE,this.onOrientation,this),this._orientation.start()},this),egret.Tween.get(this._item2).to({y:579},300).call(function(){this._item2_1.visible=!0},this)},h.frame=function(){this._findex++,this._findex>=this._frameIndex&&(this._findex=0,"bg1"==this._bg.name?(this._light.visible=this._light.visible?!1:!0,"item3"==this._aitem.name?(this._aitem.name="item4",this._aitem.texture=RES.getRes("item4")):(this._aitem.name="item3",this._aitem.texture=RES.getRes("item3"))):"item5"==this._aitem.name?(this._aitem.name="item6",this._aitem.texture=RES.getRes("item6")):(this._aitem.name="item5",this._aitem.texture=RES.getRes("item5")))},h.open=function(){switch(this._sc.stop(),this._bg.texture=RES.getRes("bg2"),this._bg.name="bg2",this._findex=this._frameIndex,this._szspr.removeChildren(),this._light.visible=!1,this._back.visible=!0,this._home.visible=!0,this._sindex){case 4:var t=new egret.Bitmap;t.texture=RES.getRes("s"+Math.floor(6*Math.random()+1)),t.x=this.stage.stageWidth-t.width>>1,t.y=525,this._szspr.addChild(t);break;case 2:for(var e=0,i=this._sarr.length-this._sindex;i>e;e++){var t=new egret.Bitmap;t.texture=RES.getRes("s"+Math.floor(6*Math.random()+1)),t.x=this._sarr[e].x-20,t.y=this._sarr[e].y+20,this._szspr.addChild(t)}break;case 0:for(var e=0,i=this._sarr.length-this._sindex;i>e;e++){var t=new egret.Bitmap;t.texture=RES.getRes("s"+Math.floor(6*Math.random()+1)),t.x=this._sarr[e].x,t.y=this._sarr[e].y,this._szspr.addChild(t)}}GameSound.sound_hit2.play(0,1)},h.back=function(){GameSound.sound_hit3.play(0,1),this._aitem.texture=null,this.removeEventListener(egret.Event.ENTER_FRAME,this.frame,this),this._back.visible=!1,this._home.visible=!1,this._sindex=2,this.pageReset(this._sindex)},h.onOrientation=function(t){var e=this;this._yaoNum!=Math.floor(t.alpha)&&(this._yaoNum=Math.floor(t.alpha),this._yaoNum<=180?this._left=this._yaoNum:this._right=360-this._yaoNum,this._left+this._right>=30&&this._left>0&&this._right>0&&(this._orientation.stop(),this._orientation.removeEventListener(egret.Event.CHANGE,this.onOrientation,this),this._left=0,this._right=0,this._ty.visible=!1,this._item1.visible=!1,this._item2.visible=!1,this._item2_1.visible=!1,this._aitem.texture=RES.getRes("item3"),this._aitem.name="item3",this.addEventListener(egret.Event.ENTER_FRAME,this.frame,this),this._sc=GameSound.sound_hit1.play(0,0),setTimeout(function(){e.open()},3e3)))},e}(egret.DisplayObjectContainer);egret.registerClass(Game,"Game");var GameSound=function(){function t(){}var e=(__define,t);e.prototype;return t.setSoundBG=function(e){t._soundBG=e,t.onSoundComplete(null)},t.onSoundComplete=function(e){t._soundChannel&&t._soundChannel.stop(),t._soundChannel=t._soundBG.play(0,0)},t}();egret.registerClass(GameSound,"GameSound");var LoadingUI=function(t){function e(){t.call(this),this.graphics.beginFill(16777215,1),this.graphics.drawRect(0,0,Main.stage.stageWidth,Main.stage.stageHeight),this.graphics.endFill(),this.createView()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.createView=function(){this.loadingshapedemo=new egret.Shape,this.loadingshapedemo.graphics.lineStyle(20,15724527),this.loadingshapedemo.graphics.drawArc(Main.stage.stageWidth/2,Main.stage.stageHeight/2,200,0,2*Math.PI,!1),this.loadingshapedemo.graphics.endFill(),this.addChild(this.loadingshapedemo),this.textField=new egret.TextField,this.textField.size=40,this.textField.y=300,this.textField.height=100,this.textField.textAlign=egret.HorizontalAlign.CENTER,this.textField.verticalAlign=egret.VerticalAlign.MIDDLE,this.textField.text="loading...",this.textField.textColor=0,this.textField.bold=!0,this.textField.x=Main.stage.stageWidth-this.textField.width>>1,this.textField.y=Main.stage.stageHeight-this.textField.height>>1,this.addChild(this.textField),this.loadingshape=new egret.Shape,this.addChild(this.loadingshape)},s.setProgress=function(t,e){this.loadingshape.graphics.clear(),this.loadingshape.graphics.lineStyle(20,13970206),this.loadingshape.graphics.drawArc(Main.stage.stageWidth/2,Main.stage.stageHeight/2,200,0,2*Math.PI*t/e,!1),this.loadingshape.graphics.endFill()},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){e.stage=this.stage,RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.txt","resource/")},s.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preload")},s.onResourceLoadComplete=function(t){"preload"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.createGameScene())},s.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},s.onResourceProgress=function(t){"preload"==t.groupName},s.createGameScene=function(){this.addChild(Game.instance)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var Tips=function(t){function e(){t.call(this),this.graphics.beginFill(0,.75),this.graphics.drawRect(0,0,Main.stage.stageWidth,Main.stage.stageHeight),this.graphics.endFill();var e=new egret.Bitmap(RES.getRes("tips"));e.x=this.width-e.width>>1,e.y=this.height-e.height>>1,this.addChild(e),this.touchEnabled=!0}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Sprite);egret.registerClass(Tips,"Tips");