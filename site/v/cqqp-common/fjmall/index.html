<!DOCTYPE html>
<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
		<meta name="viewport" content="width=device-width,viewport-fit=cover" />
		<title>汾酒积分商城</title>
		<link rel="stylesheet" href="css/reset.css?v=1.1.0">
		<link rel="stylesheet" href="css/index.css?v=1.3.0">
	</head>

	<body>
		<div id="index">
			<!--首页-->
			<div id="mall" style="display: none;">
				<div id="banner">
					<ul class="pic_box">
					</ul>
					<ul class="dot">
					</ul>
				</div>
				<div id="jifen">
					<p></p>
					<span>我的积分</span>
				</div>
				<div class="scroll-box">
					<div id="hot">
						<p class="h3-title">积分好礼</p>
						<div style="overflow-y: hidden;">
							<ul>
							</ul>
						</div>
					</div>
					<div id="content">
						<p class="h3-title">兑换专区</p>
						<div class="goods-list">

						</div>
					</div>
				</div>
				
			</div>
			<!--首页End-->
			<!--购物车-->
			<div id="shopcart_page">
				<p class="edit"><span>编辑</span></p>
				<!-- 购物车商品列表 -->
				<div class="spcartlist">
					
				</div>
				<!-- 购物车商品列表End -->
				<!-- 为你推荐 -->
				<div class="recommend">
					<p class="rec-title">为/你/推/荐</p>
					<div class="rec-list">
					</div>
				</div>
				<!-- 为你推荐End -->
			</div>
			<!--购物车End-->
			<!--个人中心-->
			<div id="person" style="display: block;">
				<div id="msg_bg">
					<img src="img/headimg.png" class="headimg" />
					<p class="nickname"></p>
				</div>
				<div id="order">
					<p class="h3-title">订单管理
						<a class="getmore bg-toright" onclick="order_page('all')">查看全部</a>
					</p>
					<div class="order_classfiy">
						<p state="send">待发货</p>
						<p state="receive">已发货</p>
						<p state="finish">已完成</p>
					</div>
				</div>
				<div id="function">
					<p class="h3-title">常用功能</p>
					<p class="myorder">
						<a onclick="order_page('all')">我的订单</a>
					</p>
					<p class="address">
						<!--此处进入不会跳转到订单页 参数index=1-->
						<a href="address.html?index=1">地址管理</a>
					</p>
					<p class="integral">
						<a href="integral.html">积分明细</a>
					</p>
					<p class="rule"><a href="rule.html">规则说明</a></p>
					<p class="custom_service">客户服务</p>
				</div>

			</div>
			<!--个人中心End-->
			<!--订单管理-->
			<div id="order_page" style="display: none;">

			</div>
			<!--订单管理End-->

			<!--积分明细-->
			<div id="integral_page" style="display: none;">
			</div>
			<!--积分明细End-->
			<!--地址管理-->
			<div id="address_page">

			</div>
			<!--地址管理End-->
			<!--客服弹窗-->
			<div id="kefu">
				<span class="closeKf"></span>
				<div class="kefu">
					<p>联系客服</p>
					<a href="tel:4008-365-591">拨打电话:4008-365-591</a>
					<p style="font-size: .56rem;">工作时间：周一至周五9:00:00-18:00:00</p>
				</div>
			</div>
			<!--客服弹窗End-->
			<!-- 购物车结算 -->
			<div class="settle-accounts">
				<p class="selectall_box"><span class="selectall isSelected">全选</span><span>合计:<i>0</i>积分</span></p>
				<p class="settle">去结算(<span>0</span>)</p>
				<p class="delete" style="display: none;">删除</p>
			</div>
			<!-- 导航 -->
			<div id="tab-box">
				<div class="indexbtn">
					<a id="indexbtn">商城</a>
				</div>
				<div class="shopcartbtn">
					<i>0</i>
					<a id="shopcartbtn">购物车</a>
				</div>
				<div class="personbtn">
					<a id="personbtn">我的</a>
				</div>
			</div>
		</div>
		<div class="screen">
			<img src="img/screen.jpg" class="screen_pic"/>
		</div>
	</body>
	<script src="/static/js/wx/jsdk.js?v12"></script>
	<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
	<script src="/static/js/rem.js"></script>
	<script src="/static/js/jquery-2.2.4.min.js"></script>
	<script src="/static/js/vve/10core.js?v=1"></script>
	<script src="/static/js/vve/11tool.js?v=1"></script>
	<script src="/static/js/vve/12event.js?v=1"></script>
	<script src="/static/js/vve/20ajx.js?v=1"></script>
	<script src="/v/js/cfg.js?v=3.9.9"></script>
	<script src="/v/js/publictip.js?v=2.0.1"></script>
	<script src="js/router.js"></script>
	<script src="/static/js/font.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/screen.js?v=1.0.4" type="text/javascript" charset="utf-8"></script>
	<script src="js/share.js?v=1.0.1" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript" src="https://res.wx.qq.com/open/libs/weuijs/1.1.4/weui.min.js"></script>
	<script>
		document.getElementById("indexbtn").addEventListener('click', function() {
			location.replace(location.href.split('#')[0] + '#/index');
		}, false)
		document.getElementById("personbtn").addEventListener('click', function() {
			location.replace(location.href.split('#')[0] + '#/person');
		}, false)
		document.getElementById("shopcartbtn").addEventListener('click', function() {
			location.replace(location.href.split('#')[0] + '#/shopcart');
		}, false)

		$('.order_classfiy p').on('click', function() {
			sessionStorage.orderState = $(this).attr('state');
			location.href = 'order.html';
		})

		function order_page(state) {
			sessionStorage.orderState = state;
			location.href = 'order.html';
		}
		spaRouters.map('/index', function(transition) {
			//异步加载js
			var indexFlag = true;
			$('script').each(function() {
				if(this.src.indexOf('/fjmall/js/index.js?v=1.2.5') != -1) {
					indexFlag = false;
				}
			})
			if(indexFlag) {
				spaRouters.asyncFun('/v/fjmall/js/index.js?v=1.2.5', transition)
			}
			//或者同步执行回调
			spaRouters.syncFun(function(transition) {
				$('.settle-accounts').css('visibility','hidden');
				$('.indexbtn').css('background-image', 'url(/v/fjmall/img/icon-index-selected.png)');
				$('.indexbtn a').css('color', '#003e92');
				$('.shopcartbtn').css('background-image', 'url(/v/fjmall/img/icon-shopcart.png)');
				$('.shopcartbtn a').css('color', '#999');
				$('.personbtn').css('background-image', 'url(/v/fjmall/img/icon-person.png)');
				$('.personbtn a').css('color', '#999');
				$('#mall').css('display', 'block');
				$('#person,#shopcart_page').css('display', 'none');
				if(sessionStorage.surplusVpoints) {
					$('#jifen>p').text(transfNum(Number(sessionStorage.surplusVpoints)));
				}
				//				var margl = $('#hot ul').css('margin-left');
				//				$('#hot ul').css({
				//					'transition': 'none',
				//					'margin-left': 0
				//				}); //init
				//				console.log(margl,$('#hot ul').css('margin-left'))
				//				if(margl != '0px'){
				//					setTimeout(function(){
				//						$('#hot ul').css('margin-left',margl);
				//						$('#hot ul').css({
				//							'transition': 'all ' + sessionStorage.hotlist * 1.5 + 's linear',
				//							'margin-left': margl
				//						});
				//					},50)
				//				}

			}, transition)
		})
		spaRouters.map('/shopcart', function(transition) {
			//异步加载js
			var indexFlag = true;
			$('script').each(function() {
				if(this.src.indexOf('/fjmall/js/shopcart.js?v=1.1.6') != -1) {
					indexFlag = false;
				}
			})
			if(indexFlag) {
				spaRouters.asyncFun('/v/fjmall/js/shopcart.js?v=1.1.6', transition)
			}
			spaRouters.syncFun(function(transition) {
				$('.settle-accounts').css('visibility','visible');
				$('.indexbtn').css('background-image', 'url(/v/fjmall/img/icon-index.png)');
				$('.indexbtn a').css('color', '#999');
				$('.shopcartbtn').css('background-image', 'url(/v/fjmall/img/icon-shopcart-selected.png)');
				$('.shopcartbtn a').css('color', '#003e92');
				$('.personbtn').css('background-image', 'url(/v/fjmall/img/icon-person.png)');
				$('.personbtn a').css('color', '#999');
				$('#shopcart_page').css('display', 'block');
				$('#mall,#person').css('display', 'none');
				if(sessionStorage.surplusVpoints) {
					$('#jifen>p').text(transfNum(Number(sessionStorage.surplusVpoints)));
				}
			}, transition)
		})
		spaRouters.map('/person', function(transition) {
			//异步加载js
			var indexFlag = true;
			$('script').each(function() {
				if(this.src.indexOf('/fjmall/js/index.js?v=1.2.5') != -1) {
					indexFlag = false;
				}
			})
			if(indexFlag) {
				spaRouters.asyncFun('/v/fjmall/js/index.js?v=1.2.5', transition)
			}
			spaRouters.syncFun(function(transition) {
				$('.settle-accounts').css('visibility','hidden');
				$('.indexbtn').css('background-image', 'url(/v/fjmall/img/icon-index.png)');
				$('.indexbtn a').css('color', '#999');
				$('.shopcartbtn').css('background-image', 'url(/v/fjmall/img/icon-shopcart.png)');
				$('.shopcartbtn a').css('color', '#999');
				$('.personbtn').css('background-image', 'url(/v/fjmall/img/icon-person-selected.png)');
				$('.personbtn a').css('color', '#003e92');
				$('#person').css('display', 'block');
				$('#mall,#shopcart_page').css('display', 'none');
				if(sessionStorage.surplusVpoints) {
					$('#jifen>p').text(transfNum(Number(sessionStorage.surplusVpoints)));
				}
				$('#person .nickname').text(sessionStorage.nickname);
				$('#person .headimg').attr('src', sessionStorage.headimgurl);
			}, transition)
		})
		//		spaRouters.map('/order_page', function(transition) {
		//			//异步加载js
		//			var orderFlag = true;
		//			$('script').each(function() {
		//				if(this.src.indexOf('/fjmall/js/order.js') != -1) {
		//					orderFlag = false;
		//				}
		//			})
		//			if(orderFlag) {
		//				spaRouters.asyncFun('/v/fjmall/js/order.js', transition)
		//			}
		//			//或者同步执行回调
		//			spaRouters.syncFun(function(transition) {
		//				console.log(location.href, transition);
		//				$('#order_page').css('display', 'block');
		//				$('#person').css('display', 'none');
		//				$("script[src='/v/fjmall/js/index.js']").remove();
		//			}, transition)
		//		})

		//		spaRouters.map('/integral_page', function(transition) {
		//			//异步加载js
		//			var integralFlag = true;
		//			$('script').each(function() {
		//				if(this.src.indexOf('/fjmall/js/integral_page.js') != -1) {
		//					integralFlag = false;
		//				}
		//			})
		//			if(integralFlag) {
		//				spaRouters.asyncFun('/v/fjmall/js/integral_page.js', transition)
		//			}
		//			//或者同步执行回调
		//			spaRouters.syncFun(function(transition) {
		//				$('#order_page,#person').css('display', 'none');
		//				$('#integral_page').css('display', 'block');
		//				$("script[src='/v/fjmall/js/integral_page.js']").remove();
		//			}, transition)
		//		})

		//		spaRouters.map('/order_details_page', function(transition) {
		//			//异步加载js
		//			var orderFlag = true;
		//			$('script').each(function() {
		//				if(this.src.indexOf('/fjmall/js/integral_page.js') != -1) {
		//					orderFlag = false;
		//				}
		//			})
		//			if(orderFlag) {
		//				spaRouters.asyncFun('/v/fjmall/js/integral_page.js', transition)
		//			}
		//			//或者同步执行回调
		//			spaRouters.syncFun(function(transition) {
		//				$('#order_page,#person,#integral_page').css('display', 'none');
		//				$('#order_details_page').css('display', 'block');
		//				$("script[src='/v/fjmall/js/integral_page.js']").remove();
		//			}, transition)
		//		})
		spaRouters.init()

		function transfNum(num) {
			if(num < 1000) {
				return num;
			} else {
				var str = num + '',
					reg = /\*/g;
				var arr = '',
					Int = '',
					Float = '',
					resStr1 = [],
					resStr2 = [];
				if(str.indexOf(".") !== -1) {
					arr = str.split(".");
					Int = arr[0].split('');
					Float = arr[1].split('');
				} else {
					Int = str.split('');
				}
				Int = Int.reverse();
				for(var i = 0; i < Int.length; i++) {
					resStr1.push(Int[i]);
					if(i % 3 === 2) {
						resStr1.push(',');
					}
				}
				resStr1 = resStr1.reverse().join('*');
				resStr1 = resStr1.replace(reg, '');
				if(resStr1[0] == ',') {
					resStr1 = resStr1.substr(1, resStr1.length);
				}
				for(var j = 0; j < Float.length; j++) {
					resStr2.push(Float[j]);
					if(j % 3 === 2) {
						resStr2.push(',');
					}
				}
				resStr2 = resStr2.join('*');
				resStr2 = resStr2.replace(reg, '');
				if(resStr2[resStr2.length - 1] == ',') {
					resStr2 = resStr2.substr(0, resStr2.length - 1);
				}
				if(Float.length < 1) {
					return resStr1;
				} else {
					return resStr1 + '.' + resStr2;
				}
			}
		}
	</script>
	<script type="text/javascript">
		if(document.documentElement.clientHeight/document.documentElement.clientWidth>1.95){
			$('html,body').css({'padding-bottom':'20px','box-sizing':'border-box','position':'relative','background':'#fff'});
		}
	</script>
</html>