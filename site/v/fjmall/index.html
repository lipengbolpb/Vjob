<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
		<meta name="viewport" content="width=device-width,viewport-fit=cover" />
		<title>汾酒积分商城</title>
		<link rel="stylesheet" href="css/reset.css?v=1.1.0">
		<link rel="stylesheet" href="css/index.css?v=1.5.1">
		<link rel="stylesheet" href="plugins/swipeslider/swipeslider.css">
	</head>

	<body>
		<div id="index">
			<!--首页-->
			<div id="mall" class="page-wrap" style="display: none;">
				<div id="banner"  style="display: none;">
					<ul class="pic_box">
					</ul>
					<ul class="dot">
					</ul>
				</div>
				<!-- 新改的顶部banner图 -->
				<div id="new-banner" class="banner-top">
					<div id="jifen" class="jifen">
						<span>我的积分</span>
						<span class="jifen-number"></span>
						<!-- <span class="color-yellow">积分</span> -->
					</div>
				</div>
				<!-- 新改的顶部banner图 end--> 
				<div class="scroll-box">
					<div style="text-align: center; font-size: 0.767rem;margin-top: .426439rem;">更多商品，陆续上架，敬请期待</div>
					<div id="hot-goods-box" class="hot-goods-box">
						<!-- 分类标题 -->
						<p class="list-title" style="margin-top: .426439rem">
							<img src="./img/list-title-top.png" alt="" class="decorate">
							<span class="title-text">热门推荐</span>
						</p>
						<div class="hot-look-more look-more"></div>
					</div>


					<div class="title-bg" id="title-bg">
						<img src="./img/list-title-top.png" alt="" class="title-decorate">
					</div>

					<div class="swiperlider-wrap">
						<div class="swipslider">
							<div class="sw-slides"></div>
						</div>
					</div>

					<div class="slider to-look-more">
						<span class="">查看更多</span>
						<span class="text-arrow-right">>></span>
					</div>

					<div id="might-like" class="common-type-box">
						<p class="list-title">
							<img src="./img/list-title-top.png" alt="" class="decorate">
							<span class="title-text">智能推荐</span>
						</p>
					</div>
				</div>
				
			</div>
			<!--首页End-->
			<!--分类-->
			<div id="type_page" class="page-wrap" style="display: none;">
				<img src="./img/flower.png" alt="" class="flower-img">
				<div class="tab-left-box">
					<!-- <div class="tab-item">
						<span class="tab-btn active">生活周边</span>
					</div> -->
				</div>
				<div class="right-wrap">
					<div class="condition-box">
						<div class="condition-text desc">商品排序</div>
						<div class="condition-text order-btn  order-up active" data-order="0">积分正序</div>
						<div class="condition-text order-btn order-down" data-order="1">积分倒序</div>
					</div>
				</div>
				<!-- <div class="right-list-box"> -->
					<!-- <div class="type-list-box">
						<p class="type-title">生活周边</p>
					</div> -->
				<!-- </div> -->
			</div>
			<!--分类End-->
			<!--购物车-->
			<div id="shopcart_page" class="page-wrap" style="display: none;">
				<div class="no-goods-wrap">
					<div class="content-box"></div>
				</div>
				<p class="edit"><span>编辑</span></p>
				<!-- 购物车商品列表 -->
				<div class="spcartlist">
						<div class="content-box"></div>
				</div>
				<!-- 购物车商品列表End -->
				<!-- 为你推荐 -->
				<div class="recommend common-type-box">
					<!-- <p class="rec-title">为/你/推/荐</p> -->
					<p class="list-title rec-title">
						<img src="./img/list-title-top.png" alt="" class="decorate">
						<span class="title-text">为/你/推/荐</span>
					</p>
					<div class="rec-list">
					</div>
				</div>
				<!-- 为你推荐End -->
			
			</div>
			<!--购物车End-->
			<!--个人中心-->
			<div id="person" class="page-wrap" style="display: none;">
				<div id="msg_bg">
					<img src="img/headimg.png" class="headimg" />
					<p class="nickname"></p>
				</div>
				<div id="order">
					<p class="h3-title">订单管理
						<a class="getmore bg-toright" onclick="order_page('all')">查看全部</a>
					</p>
					<div class="order_classfiy">
						<p state="send">待发货</p>
						<p state="receive">已发货</p>
						<p state="finish">已完成</p>
					</div>
				</div>
				<div id="function">
					<p class="h3-title">常用功能</p>
					<p class="myorder">
						<a onclick="order_page('all')">我的订单</a>
					</p>
					<p class="address">
						<!--此处进入不会跳转到订单页 参数index=1-->
						<a href="address.html?index=1">地址管理</a>
					</p>
					<p class="integral">
						<a href="integral.html">积分明细</a>
					</p>
					<p class="rule"><a href="rule.html">规则说明</a></p>
					<p class="custom_service">客户服务</p>
				</div>

			</div>
			<!--个人中心End-->
			<!--订单管理-->
			<div id="order_page" style="display: none;">

			</div>
			<!--订单管理End-->

			<!--积分明细-->
			<div id="integral_page" style="display: none;">
			</div>
			<!--积分明细End-->
			<!--地址管理-->
			<div id="address_page">

			</div>
			<!--地址管理End-->
			<!--客服弹窗-->
			<div id="kefu">
				<span class="closeKf"></span>
				<div class="kefu">
					<p>联系客服</p>
					<a href="tel:4008-365-591">拨打电话:4008-365-591</a>
					<p style="font-size: .56rem;">工作时间：周一至周五9:00:00-18:00:00</p>
				</div>
			</div>
			<!--客服弹窗End-->
			<!-- 购物车结算 -->
			<div class="settle-accounts">
				<p class="selectall_box"><span class="selectall isSelected">全选</span><span id="heji">合计:<i>0</i>积分</span></p>
				<p class="settle">去结算(<span>0</span>)</p>
				<p class="delete" style="display: none;">删除</p>
			</div>
			<!-- 导航 -->
			<div id="tab-box">
				<div class="indexbtn">
					<!-- <a id="indexbtn" href="#/index">商城</a> -->
					<a id="indexbtn" data-hash="#/index">商城</a>
				</div>
				<div class="typebtn">
					<!-- <a id="typebtn" href="#/type">分类</a> -->
					<a id="typebtn" data-hash="#/type">分类</a>
				</div>
				<div class="shopcartbtn">
					<i data-hash="#/shopcart">0</i>
					<!-- <a id="shopcartbtn" href="#/shopcart">购物车</a> -->
					<a id="shopcartbtn" data-hash="#/shopcart">购物车</a>
				</div>
				<div class="personbtn">
					<!-- <a id="personbtn" href="#/person">我的</a> -->
					<a id="personbtn" data-hash="#/person">我的</a>
				</div>
			</div>
		</div>
		<div class="screen">
			<img src="img/screen.jpg" class="screen_pic"/>
		</div>

		<div id="point-tip">
			<div class="point-tip-cont">
				<div class="tip-title">积分不足</div>
				<div class="tip-text">请再多攒点积分~</div>
				<img src="./img/icon-close.png" alt="" class="close-img">
			</div>
		</div>
	</body>
	<script src="/static/js/wx/jsdk.js?v12"></script>
	<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
	<script src="/static/js/rem.js"></script>
	<script src="/static/js/jquery-2.2.4.min.js"></script>
	<script src="/static/js/vve/10core.js?v=1"></script>
	<script src="/static/js/vve/11tool.js?v=1"></script>
	<script src="/static/js/vve/12event.js?v=1"></script>
	<script src="/static/js/vve/20ajx.js?v=1"></script>
	<script src="/v/js/cfg.js?v=3.9.9"></script>
	<script src="/v/js/publictip.js?v=2.0.1"></script>
	<script src="js/router.js"></script>
	<script src="/static/js/font.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/screen.js?v=1.0.4" type="text/javascript" charset="utf-8"></script>
	<script src="js/share.js?v=1.0.1" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript" src="https://res.wx.qq.com/open/libs/weuijs/1.1.4/weui.min.js"></script>
	<script src="plugins/swipeslider/swipeslider.min.js?v=0.0.3"></script>
	<script>
		// 监听底部菜单点击事件
		$('#tab-box').click(function(e) {
			var targetHash = $(e.target).attr('data-hash');
			location.replace(location.href.split('#')[0] + targetHash);
		})

		$('.order_classfiy p').on('click', function() {
			sessionStorage.orderState = $(this).attr('state');
			location.href = 'order.html';
		})

		function order_page(state) {
			sessionStorage.orderState = state;
			location.href =  'http://' + location.host + '/v/fjmall/' + 'order.html';
		}
		spaRouters.map('/index', function(transition) {
			//异步加载js
			asyncLoadJs({file: 'index.js'}, transition)
		
			//或者同步执行回调
			spaRouters.syncFun(function(transition) {
				handleMenuChange('.indexbtn', '#mall')
			}, transition)
		})
		spaRouters.map('/type', function(transition) {
		//异步加载js
		asyncLoadJs({file: 'type.js'}, transition)

		spaRouters.syncFun(function(transition) {
		handleMenuChange('.typebtn', '#type_page')

		}, transition)
		})
		spaRouters.map('/shopcart', function(transition) {
			//异步加载js
			asyncLoadJs({file: 'shopcart.js'}, transition)
			
			spaRouters.syncFun(function(transition) {
				handleMenuChange('.shopcartbtn', '#shopcart_page', true)

			}, transition)
		})
		spaRouters.map('/person', function(transition) {
			//异步加载js
			asyncLoadJs({file: 'person.js'}, transition)
			
			spaRouters.syncFun(function(transition) {

				handleMenuChange('.personbtn', '#person')
				
				$('#person .nickname').text(sessionStorage.nickname);
				$('#person .headimg').attr('src', sessionStorage.headimgurl);
			}, transition)
		})
		spaRouters.init()

		// 点击菜单切换页面时的相应操作
		function handleMenuChange(menuSelect, pageselect, isShopcar) {
			// 切换底部按钮		
			$('#tab-box>div').removeClass('active')
			$(menuSelect).addClass('active')
			// 切换显示页面
			$('.page-wrap').css('display', 'none');
			$(pageselect).css('display', 'block');

			if(isShopcar) { // 购物车页
				$('.settle-accounts').css('visibility','visible');
			} else {
				$('.settle-accounts').css('visibility','hidden');
			}

			if(sessionStorage.surplusVpoints) {
				$('#jifen>p').text(transfNum(Number(sessionStorage.surplusVpoints)));
			}
		};

		/**
		* 切换页面时异步加载对应的js
		* @param options: {
		*	file: 需要加载的文件; 必填
		*	path: 文件路径
		*	version 文件版本哈
		*  } 
		* @returns {Array}
		*/
		function asyncLoadJs(options, transition) {
			var path = options.path || '/v/fjmall/js/';
			var version = options.version || '0.0.8';
			var filePath = path + options.file + '?v=' + version;
			var indexFlag = true
			$('script').each(function() {
				if(this.src.indexOf(filePath) != -1) {
					indexFlag = false;
				}
			})
			if(indexFlag) {
				spaRouters.asyncFun(filePath, transition)
			}
		}

		function transfNum(num) {
			if(num < 1000) {
				return num;
			} else {
				var str = num + '',
					reg = /\*/g;
				var arr = '',
					Int = '',
					Float = '',
					resStr1 = [],
					resStr2 = [];
				if(str.indexOf(".") !== -1) {
					arr = str.split(".");
					Int = arr[0].split('');
					Float = arr[1].split('');
				} else {
					Int = str.split('');
				}
				Int = Int.reverse();
				for(var i = 0; i < Int.length; i++) {
					resStr1.push(Int[i]);
					if(i % 3 === 2) {
						resStr1.push(',');
					}
				}
				resStr1 = resStr1.reverse().join('*');
				resStr1 = resStr1.replace(reg, '');
				if(resStr1[0] == ',') {
					resStr1 = resStr1.substr(1, resStr1.length);
				}
				for(var j = 0; j < Float.length; j++) {
					resStr2.push(Float[j]);
					if(j % 3 === 2) {
						resStr2.push(',');
					}
				}
				resStr2 = resStr2.join('*');
				resStr2 = resStr2.replace(reg, '');
				if(resStr2[resStr2.length - 1] == ',') {
					resStr2 = resStr2.substr(0, resStr2.length - 1);
				}
				if(Float.length < 1) {
					return resStr1;
				} else {
					return resStr1 + '.' + resStr2;
				}
			}
		}
	</script>
	<script type="text/javascript">
		if(document.documentElement.clientHeight/document.documentElement.clientWidth>1.95){
			$('html,body').css({'padding-bottom':'20px','box-sizing':'border-box','position':'relative','background':'#fff'});
		}
	</script>
</html>